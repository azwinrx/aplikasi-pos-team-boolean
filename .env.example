# App Configuration
APP_NAME=aplikasi-pos















































































































































































































































































































5. **Reset Password** → reset password dengan OTP yang valid4. **Validate OTP** → validasi OTP code (gunakan OTP dari email/logs)3. **Send OTP** → kirim OTP ke email2. **Check Email** → validasi email terdaftar1. **Login** → dapatkan JWT token### Flow Testing:Lihat file `Postman Collection/Authentication.postman_collection.json` untuk full collection dengan contoh request dan response.## Testing dengan Postman---- Jika SMTP tidak dikonfigurasi, email akan di-skip (tidak error)- Aktifkan "Less secure app access" atau setup 2FA + App Password- Gunakan Gmail App Password, bukan password akun biasa**Note:** ```SMTP_PASSWORD=your_app_password_hereSMTP_EMAIL=your_email@gmail.comSMTP_PORT=587SMTP_HOST=smtp.gmail.com```Untuk mengirim email, configure SMTP settings di `.env`:## SMTP Configuration---6. **Password Validation:** Password minimum 6 character5. **Email Validation:** Semua email harus valid format4. **Deleted Users:** User yang dihapus tidak bisa login lagi3. **OTP Expiry:** OTP berlaku hanya 10 menit2. **JWT Token:** Token di-generate dengan secret key dan expiry time1. **Password Hashing:** Semua password di-hash menggunakan bcrypt## Security Notes---| 500 | Internal Server Error | Database error atau server error || 401 | Unauthorized | Invalid email/password atau invalid OTP || 400 | Bad Request | Invalid request body atau data tidak valid || 200 | Success | Request berhasil diproses ||-------------|---------|-------------|| Status Code | Message | Description |## Error Codes---| staff@pos.com | staff123 | staff || manager@pos.com | manager123 | manager || admin@pos.com | admin123 | admin ||-------|----------|------|| Email | Password | Role | ## Default Users (Seeded Data)---```CREATE INDEX idx_otps_email ON otps(email););  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  expires_at TIMESTAMP NOT NULL,  is_used BOOLEAN DEFAULT false,  purpose VARCHAR(50) DEFAULT 'password_reset',  otp_code VARCHAR(10) NOT NULL,  email VARCHAR(100) NOT NULL,  id SERIAL PRIMARY KEY,CREATE TABLE otps (```sql### OTPs Table```CREATE INDEX idx_users_is_deleted ON users(is_deleted);CREATE INDEX idx_users_role ON users(role);CREATE INDEX idx_users_email ON users(email););  deleted_at TIMESTAMP NULL  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  is_deleted BOOLEAN DEFAULT false,  status VARCHAR(20) DEFAULT 'active',  role VARCHAR(20) DEFAULT 'user',  name VARCHAR(100) NOT NULL,  password VARCHAR(255) NOT NULL,  email VARCHAR(100) UNIQUE NOT NULL,  id SERIAL PRIMARY KEY,CREATE TABLE users (```sql### Users Table## Database Schema---- Return pesan sukses- Mark OTP sebagai used- Update password di database- Hash new password sebelum disimpan- Validasi OTP terlebih dahulu**Features:**```}  }    "message": "Password reset successfully. You can now login with your new password."    "email": "admin@pos.com",  "data": {  "message": "Password reset successfully. You can now login with your new password.",  "status": true,{```json**Success Response (200):**```}  "purpose": "password_reset"  "new_password": "newpassword123",  "otp_code": "123456",  "email": "admin@pos.com",{```json**Request Body:****Purpose:** Mereset password user dengan validasi OTP**Endpoint:** `POST /api/v1/auth/reset-password`### 5. Reset Password---- Case-sensitive OTP validation- Auto-mark OTP sebagai used setelah validasi- Validasi OTP belum digunakan (is_used = false)- Validasi OTP belum expired- Validasi OTP code sesuai email & purpose**Features:**```}  "data": null  "message": "invalid or expired OTP",  "status": false,{```json**Error Response (400):**```}  }    "token": "123456"    "message": "OTP is valid",    "valid": true,  "data": {  "message": "OTP is valid",  "status": true,{```json**Success Response (200):**```}  "purpose": "password_reset"  "otp_code": "123456",  "email": "admin@pos.com",{```json**Request Body:****Purpose:** Memvalidasi OTP code yang dikirim ke email**Endpoint:** `POST /api/v1/auth/validate-otp`### 4. Validate OTP---- Logging untuk setiap aktivitas- Kirim OTP via email dengan format HTML- Set OTP expiry 10 menit dari sekarang- Validasi email terdaftar (khusus password_reset)- Generate 6-digit random OTP code**Features:**```}  }    "message": "OTP has been sent to your email. Valid for 10 minutes."    "email": "admin@pos.com",  "data": {  "message": "OTP has been sent to your email. Valid for 10 minutes.",  "status": true,{```json**Success Response (200):**- `email_verification` - untuk verifikasi email- `password_reset` - untuk reset password**Allowed Purposes:**```}  "purpose": "password_reset"  "email": "admin@pos.com",{```json**Request Body:****Purpose:** Mengirim OTP ke email user untuk password reset**Endpoint:** `POST /api/v1/auth/send-otp`### 3. Send OTP---- Return boolean exists flag- Validasi email tidak dihapus- Check keberadaan email**Features:**```}  }    "message": "email already registered"    "exists": true,    "email": "admin@pos.com",  "data": {  "message": "email already registered",  "status": true,{```json**Success Response (200):**```}  "email": "admin@pos.com"{```json**Request Body:****Purpose:** Mengecek apakah email sudah terdaftar di sistem**Endpoint:** `POST /api/v1/auth/check-email`### 2. Check Email---- Return token dan user information- Generate JWT token dengan expiry time- Pengecekan apakah user sudah dihapus (is_deleted)- Validasi email dan password**Features:**```}  "data": null  "message": "invalid email or password",  "status": false,{```json**Error Response (401):**```}  }    "expires_at": 1640000000    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",    "role": "admin",    "name": "Admin User",    "email": "admin@pos.com",    "id": 1,  "data": {  "message": "Login successful",  "status": true,{```json**Success Response (200):**```}  "password": "admin123"  "email": "admin@pos.com",{```json**Request Body:****Purpose:** Melakukan login dengan email dan password**Endpoint:** `POST /api/v1/auth/login`### 1. Login## EndpointsAPI Authentication menyediakan fitur login, validasi email, OTP verification, dan password reset untuk aplikasi POS.## OverviewPORT=8080
DEBUG=true
LIMIT=10
PATH_LOGGING=./logs/

# Konfigurasi Database PostgreSQL
DATABASE_USERNAME=postgres
DATABASE_PASSWORD=your_password_here
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=database-aplikasi-pos
DATABASE_MAX_CONN=10
# JWT Configuration
JWT_SECRET=your_jwt_secret_key_here_change_in_production
JWT_EXPIRY_HOURS=24

# SMTP Configuration untuk Email
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_EMAIL=your_email@gmail.com
SMTP_PASSWORD=your_app_password_here